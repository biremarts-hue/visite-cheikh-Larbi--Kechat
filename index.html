function createDateCard(dateObj) {
    const card = document.createElement('div');
    card.className = 'date-card';

    const dateHeader = document.createElement('div');
    dateHeader.className = 'date-header';
    dateHeader.textContent =
        `${dateObj.day} ${new Date(dateObj.date).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long' })}`;

    const dateInfo = document.createElement('div');
    dateInfo.className = 'date-info';
    dateInfo.textContent = `Jour ${dateObj.ramadanDay}`;

    const timeSlotsDiv = document.createElement('div');
    timeSlotsDiv.className = 'time-slots';

    // Week-end = Asr seulement, semaine = Icha
    const availableSlots = dateObj.isWeekend ? [timeSlotAsr] : [timeSlotIcha];

    let hasReservedSlot = false;

    const cardDateISO = dateObj.date; // format ISO s√ªr : YYYY-MM-DD

    availableSlots.forEach(slot => {

        const isReserved = reservations.some(r => {

            // üî• Normalisation FIABLE des dates
            let rDateISO = '';

            if (r.date) {
                rDateISO = r.date; // d√©j√† ISO
            } else if (r.Date) {
                // convertit 23/02/2026 ‚Üí 2026-02-23
                rDateISO = r.Date.split('/').reverse().join('-');
            }

            const rHoraire = r.horaire || r.Horaire;

            return rDateISO === cardDateISO && rHoraire === slot.label;
        });

        if (isReserved) hasReservedSlot = true;

        const timeSlot = document.createElement('div');

        timeSlot.className = `time-slot ${isReserved ? 'reserved' : ''}`;

        timeSlot.innerHTML =
            `${slot.label}<br><small>${slot.time}</small>`;

        if (isReserved) {
            timeSlot.innerHTML +=
                '<br><strong style="color:#d32f2f;">‚ùå R√âSERV√â</strong>';
        } else {
            timeSlot.onclick = () => selectSlot(dateObj, slot, timeSlot);
        }

        timeSlotsDiv.appendChild(timeSlot);
    });

    card.appendChild(dateHeader);
    card.appendChild(dateInfo);
    card.appendChild(timeSlotsDiv);

    // ‚úÖ On NE cache plus la carte (important)
    // on la grise juste si complet
    if (hasReservedSlot) {
        card.style.opacity = '0.6';
    }

    return card;
}
